<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoTSP PPT Editor Modular</title>
    <!-- 第三方库 -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <!-- 样式表 -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <!-- 遮罩层 -->
    <div id="overlay">
        <div style="font-size: 24px; margin-bottom: 20px;" id="overlay-msg">处理中...</div>
        <div style="width: 400px; height: 6px; background: #444; border-radius: 3px; overflow:hidden;">
            <div id="progress-bar" style="width: 0%; height: 100%; background: #28a745; transition: 0.2s;"></div>
        </div>
    </div>

    <!-- Toast 提示 -->
    <div id="toast">提示信息</div>

    <!-- 侧边栏 -->
    <div id="sidebar">
        <div id="sidebar-header">IoTSP Editor (Modular)</div>
        <div id="sidebar-list">
            <div style="padding:20px; text-align:center; color:#999; font-size:13px;" id="loading-msg">Connecting...</div>
        </div>
    </div>

    <!-- 主界面 -->
    <div id="main">
        <div id="toolbar">
            <div class="tool-group">
                <span style="font-size:18px; font-weight:bold; color:var(--accent);">PPT Editor</span>
                <span style="font-size:12px; color:#666; margin-top:4px;">(ES6 Modules)</span>
            </div>
            <div class="tool-group">
                <span id="page-indicator" style="font-size:14px; font-weight:bold;">Page 1</span>
                <button class="save-btn">💾 保存本页</button>
                <button class="secondary">📷 全图导出</button>
                <button>📥 编辑导出</button>
            </div>
        </div>

        <div id="workspace">
            <div id="canvas-wrapper" tabindex="0">
                <div id="canvas">
                    <div id="mother-layer"></div>
                    <div id="content-layer"></div>
                </div>
            </div>
            <div id="notes-panel">
                <div id="notes-header">🎤 讲演备注</div>
                <textarea id="notes-input" placeholder="输入备注..."></textarea>
            </div>
        </div>
    </div>

    <!-- 入口脚本 -->
    <script type="module" src="js/app.js"></script>
</body>
</html>